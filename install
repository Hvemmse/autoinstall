#Choice root password
echo "Coice root Password."

passwd

bios () {
lsblk -d
echo Enter driveletter /dev/sdx as a for x or b for x

read part

#install grub
grub-install --target=i386-pc ${part}

}



efi () {
lsblk -d
pacman -S efibootmgr
grub-install --target=x86_64-efi --efi-directory=boot/efi --bootloader-id=GRUB

}


if [ -d "/sys/firmware/efi/efivars" ] 
then
 efi
    
else
bios
fi

#set localtime


echo "Enter your timezone as a town?"
read town

timedatectl list-timezones | grep $town

echo "Write your timezone aka. Europe/Copenhagen"

read timez

ln -sf /usr/share/zoneinfo/$timez /etc/localtime

#locale gen

echo "en_US.UTF-8 UTF-8" >> /etc/locale.gen
echo "en_US ISO-8859-1" >> /etc/locale.gen

# run locale-gen
locale-gen

#set language in locale.conf
echo "LANG=en_US.UTF-8" > /etc/locale.conf

#set keymap 
#KEYMAP=de-latin1
echo "KEYMAP=en_US" > /etc/vconsole.conf

# set location in reflector
reflector --protocol https --country 'USA'

# enable parralel download in pacman.conf
sed -i 's/#ParallelDownloads/ParallelDownloads/g' /etc/pacman.conf


# install pakkages
pacman -Sy 
pacman -S networkmanager pulseaudio pavucontrol sudo


#set hostname > 
echo Enter Hostname?
read hostname

echo ${hostname} > /etc/hostname


#create Hostfile
echo "127.0.0.1	localhost" > /etc/hosts
echo "::1		localhost" >> /etc/hosts
echo "127.0.1.1	$hostname.localdomain	$hostname" >> /etc/hosts


# enable services
# systemctl enable lightdm
systemctl enable NetworkManager
# systemctl enable cups

#mkgrub-config
grub-mkconfig -o /boot/grub/grub.cfg

#config mkinitcpio -P
mkinitcpio -P

# set username
echo Enter a Username for the user
read user

useradd -m -G wheel -s /bin/bash ${user}

passwd ${user}

sed -i 's/# %wheels/%wheels/g' /etc/sudoers
#exit
exit
